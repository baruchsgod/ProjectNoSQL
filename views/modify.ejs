<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="utf-8">
  <title>Home Sticky</title>
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Modak&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
  <link rel="stylesheet" href="../../css/styles.css">
  <script src="https://use.fontawesome.com/f58802a848.js"></script>
</head>

<body>
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <a class="navbar-brand nav-pad" href="#">
      <img src="../../images/sticky.png" alt="sticky" class="homeSticky">
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo02" aria-controls="navbarTogglerDemo02" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarTogglerDemo02">


      <ul class="nav navbar-nav justify-content-end position-nav ">

        <li class="nav-item active">
          <a class="nav-link" href="#">Admin <span class="sr-only">(current)</span></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/home/<%= user %>">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Reports</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/home/settings/<%= user %>">Settings</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/" tabindex="-1" aria-disabled="true">LogOut</a>
        </li>
      </ul>
  </nav>
  <% if(selector==="company"){ %>


  <div class="container">
    <div class="form-group">
      <label>Select the company</label>
      <select name="selectedCompany" class="custom-select" id="inputGroupSelect01" onblur="selectedCompany(this)">
        <option selected>Choose...</option>
        <% for(i=0;i<company.length;i++){ %>

        <option value=<%= company[i].id_company %>><%= company[i].name %></option>

        <% } %>
      </select>
    </div>
    <h1 class="form_checklist">Modify company</h1>
    <form class="form_checklist" action="/modify/collection" method="POST">
      <div class="form-group">
        <label>Name</label>
        <input id="company" type="text" class="form-control" name="company" autocomplete="off" required placeholder="Add the company name">
      </div>
      <div class="form-group">
        <label>Select the country</label>
        <select name="selectedCountry" class="custom-select" id="inputGroupSelect03" required>
          <option selected>Choose...</option>
          <% for(i=0;i<countries.length;i++){ %>
          <option value=<%= countries[i].codigo %>><%= countries[i].name %></option>
          <% } %>
        </select>
      </div>
      <div class="form-group">
        <label>Number of Employees</label>
        <input id="employees" class="form-control" type="text" name="employees" required>
      </div>
      <div class="form-group">
        <label>street Addres</label>
        <input id="streetA" class="form-control" type="text" name="streetAddress" required>
      </div>
      <div class="form-group">
        <label>City</label>
        <input id="city" class="form-control" type="text" name="city" required>
      </div>
      <div class="form-group">
        <label>Department</label>
        <input id="dept" class="form-control" type="text" name="dept">
      </div>
      <div class="form-group">
        <label>Zip</label>
        <input id="zip" class="form-control" type="text" name="zip" required>
      </div>
      <div class="form-group">
        <label>Select the plan</label>
        <select name="selectedPlan" class="custom-select" id="inputGroupSelect02">
          <option selected>Choose...</option>
          <% for(i=0; i<plan.length; i++){ %>
          <option value=<%= plan[i].codigo %>><%= plan[i].category %></option>
          <% } %>
        </select>
      </div>
      <<input id="selectedCompany" type="hidden" name="selectedCompany" value="">
      <input type="hidden" name="selector" value=<%= selector%>>
      <input type="hidden" name="user" value=<%=user%>>
      <button class="btn btn-lg btn-info" type="submit">Create</button>
    </form>
    <br><br>
  </div>


  <% }else if(selector==="country") {%>
    <div class="container">
      <div class="form-group">
        <label>Select the country</label>
        <select name="selectedCountry" class="custom-select" id="inputGroupSelect04" onblur="selectedCountry()">
          <option selected>Choose...</option>
          <% for(i=0;i<countries.length;i++){ %>
          <option value=<%= countries[i].codigo %>><%= countries[i].name %></option>
            <% } %>
        </select>
      </div>
      <h1 class="form_checklist"> Modify the Country</h1>
      <form class="form_checklist" action="/compose/collection" method="POST">
        <div class="form-group">
          <label>Country</label>
          <input id="countryModify" type="text" class="form-control" name="country" autocomplete="off" required>
        </div>
        <div class="form-group">
          <label>Currency</label>
          <input id="currencyModify" type="text" class="form-control" name="currency" autocomplete="off" required>
        </div>
        <<input id="selected_country" type="hidden" name="selected_country" value="">
        <input type="hidden" name="selector" value=<%= selector%>>
        <input type="hidden" name="user" value=<%=user%>>
        <button class="btn btn-lg btn-info" type="submit">Create</button>
      </form>
    </div>



  <% }else if(selector==="plan") { %>

    <div class="container">
      <h1 class="form_checklist"> Add a Plan</h1>
      <form class="form_checklist" action="/compose/collection" method="POST">
        <div class="form-group">
          <label>Category</label>
          <input type="text" class="form-control" name="category" autocomplete="off" required>
        </div>
        <div class="form-group">
          <label>Description</label>
          <input type="text" class="form-control" name="description" autocomplete="off" required>
        </div>
        <div class="form-group">
          <label>Price</label>
          <input type="number" class="form-control" name="price" autocomplete="off" required>
        </div>
        <div class="form-group">
          <label>Quantity</label>
          <input type="number" class="form-control" name="quantity" autocomplete="off" required>
        </div>
        <input type="hidden" name="selector" value=<%= selector%>>
        <input type="hidden" name="user" value=<%=user%>>
        <button class="btn btn-lg btn-info" type="submit">Create</button>
      </form>
    </div>

  <% } %>

  <<script>
    function selectedCompany(valor){

        var company = document.getElementById('inputGroupSelect01');
        var selected_company = company.options[company.selectedIndex].value;
          var array_ejs = <%- JSON.stringify(company) %>;
          for(i=0; i<array_ejs.length; i++){

            if(array_ejs[i].id_company == selected_company){
              document.getElementById('company').value = array_ejs[i].name;

              document.getElementById('inputGroupSelect03').value = array_ejs[i].country;
              document.getElementById('employees').value = array_ejs[i].num_Employees;
              document.getElementById('streetA').value = array_ejs[i].address[0].streetAddres;
              document.getElementById('city').value = array_ejs[i].address[0].city;
              document.getElementById('dept').value = array_ejs[i].address[0].dept;
              document.getElementById('zip').value = array_ejs[i].address[0].zip;
              document.getElementById('inputGroupSelect02').value = array_ejs[i].plan;
              document.getElementById('selectedCompany').value = selected_company;

            }
          }


    }

    function selectedCountry(){
        var country = document.getElementById('inputGroupSelect01');
        var selected_country = country.options[country.selectedIndex].value;
        var country_array = <%- JSON.stringify(countries)%>;
        for(i=0; i< country_array.length; i++){
          if(country_array[i] == selected_country){
            document.getElementById('countryModify').value = country_array[i].name;
            document.getElementById('currencyModify').value = country_array[i].currency;
          }
        }
    }
  </script>
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootbox.js/5.4.0/bootbox.min.js"></script>
</body>

</html>
